<?php
/**
 * Generated by Haxe 4.0.0-rc.2+77068e10c
 */

use \php\Boot;
use \hant\Log;
use \sys\io\File;
use \hant\FileSystemTools;
use \sys\FileSystem;

class Main {
	/**
	 * @return void
	 */
	static public function main () {
		#src/Main.hx:12: characters 3-25
		$args = \Sys::args();
		#src/Main.hx:14: lines 14-31
		if ($args->length !== 1) {
			#src/Main.hx:16: characters 4-56
			Log::echo("Usage: php_fix_this <src_folder_or_file>");
		} else {
			#src/Main.hx:20: characters 8-34
			$path = ($args->arr[0] ?? null);
			clearstatcache(true, $path);
			#src/Main.hx:20: lines 20-30
			if (file_exists($path)) {
				#src/Main.hx:22: lines 22-29
				if (FileSystem::isDirectory(($args->arr[0] ?? null))) {
					#src/Main.hx:24: characters 6-53
					FileSystemTools::findFiles(($args->arr[0] ?? null), Boot::getStaticClosure(Main::class, 'processFile'));
				} else {
					#src/Main.hx:28: characters 6-26
					Main::processFile(($args->arr[0] ?? null));
				}
			}
		}
	}

	/**
	 * @param string $file
	 * 
	 * @return void
	 */
	static public function processFile ($file) {
		#src/Main.hx:36: characters 3-75
		$a = \StringTools::replace(\StringTools::replace(File::getContent($file), "\x0D\x0A", "\x0A"), "\x0D", "\x0A");
		#src/Main.hx:37: characters 3-29
		$b = \PhpFixThis::fix($a);
		#src/Main.hx:38: lines 38-42
		if ($b !== $a) {
			#src/Main.hx:40: characters 4-21
			Log::echo("FIXED");
			#src/Main.hx:41: characters 4-29
			File::saveContent($file, $b);
		}
	}

	/**
	 * @return void
	 */
	public function __construct () {
	}
}

Boot::registerClass(Main::class, 'Main');
